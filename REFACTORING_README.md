# ファイル整理アプリケーション リファクタリング

## 概要

元のコードで指摘された「単一責任原則が不足している」問題を解決するため、アプリケーションを複数のクラスに分割し、各クラスが単一の責任を持つようにリファクタリングしました。

## 改善前の問題点

### 1. `FileOrganizer`クラスが多すぎる責任を持っていた
- GUI管理
- ファイル操作
- 設定管理
- 言語管理
- ログ管理
- ファイル分類ロジック

### 2. `SettingsWindow`クラスも複数の責任を持っていた
- 設定UI管理
- ファイルタイプ管理
- 言語設定管理
- メンテナンス機能

### 3. 設定とビジネスロジックが混在していた

## リファクタリング後の構造

```
src/
├── __init__.py
├── main_app.py              # メインアプリケーション（UI調整）
├── config/
│   ├── __init__.py
│   └── config_manager.py    # 設定管理専用
├── core/
│   ├── __init__.py
│   └── file_organizer_core.py  # ファイル操作ロジック専用
├── gui/
│   ├── __init__.py
│   ├── language_dialog.py   # 言語選択ダイアログ専用
│   ├── settings_window.py   # 設定ウィンドウ専用
│   └── file_type_dialog.py  # ファイルタイプダイアログ専用
└── utils/
    ├── __init__.py
    └── logger.py            # ログ管理専用
```

## 各クラスの責任

### 1. `ConfigManager` (設定管理)
- **責任**: アプリケーション設定の管理
- **機能**:
  - 設定ファイルの読み込み・保存
  - 言語設定の管理
  - ファイルタイプカテゴリの管理
  - 最近使用したディレクトリの管理

### 2. `FileOrganizerCore` (ファイル操作ロジック)
- **責任**: ファイル整理のビジネスロジック
- **機能**:
  - ファイルの分類
  - ファイルの移動・整理
  - ファイル検索
  - ファイル分離
  - バリデーション

### 3. `Logger` (ログ管理)
- **責任**: アプリケーションログの管理
- **機能**:
  - ログメッセージの記録
  - ログの表示
  - ログのクリア
  - ログのエクスポート

### 4. `LanguageSelectionDialog` (言語選択)
- **責任**: 言語選択ダイアログの表示と処理
- **機能**:
  - 言語選択UI
  - 言語変更の処理

### 5. `SettingsWindow` (設定ウィンドウ)
- **責任**: 設定ウィンドウのUI管理
- **機能**:
  - 設定タブの管理
  - 設定値の表示・編集
  - 設定の保存

### 6. `FileTypeDialog` (ファイルタイプ管理)
- **責任**: ファイルタイプの追加・編集ダイアログ
- **機能**:
  - カテゴリ名の入力
  - 拡張子の入力
  - 入力値の検証

### 7. `FileOrganizerApp` (メインアプリケーション)
- **責任**: アプリケーション全体の調整
- **機能**:
  - 各コンポーネントの初期化
  - UIの構築
  - コンポーネント間の連携

## 単一責任原則の実現

### 1. 責任の分離
- 各クラスは明確に定義された単一の責任を持つ
- 設定管理、ファイル操作、ログ管理、UI管理が完全に分離

### 2. 依存関係の明確化
- 各クラスは必要な依存関係のみを持つ
- 循環依存を避けた設計

### 3. テスタビリティの向上
- 各クラスを個別にテスト可能
- モックやスタブの作成が容易

### 4. 保守性の向上
- 機能の追加・変更が特定のクラスに限定される
- バグの影響範囲が明確

### 5. 再利用性の向上
- 各クラスは他のプロジェクトでも再利用可能
- 依存関係が明確で移植しやすい

## 使用方法

### 1. 新しいアプリケーションの実行
```bash
python main.py
```

### 2. 元のアプリケーションの実行
```bash
python file_organizer.py
```

## 利点

1. **保守性**: 各機能が独立しているため、修正や機能追加が容易
2. **可読性**: コードの構造が明確で理解しやすい
3. **テスタビリティ**: 各クラスを個別にテスト可能
4. **拡張性**: 新しい機能の追加が既存コードに影響しない
5. **再利用性**: 各クラスを他のプロジェクトで再利用可能

## 注意事項

- 元のファイル（`file_organizer.py`）は保持されています
- 新しいリファクタリングされたコードは`src/`ディレクトリに配置されています
- 設定ファイルの形式は互換性を保っています

## 今後の改善案

1. **依存性注入**: より柔軟な依存関係の管理
2. **イベント駆動**: コンポーネント間の疎結合
3. **プラグインシステム**: 機能の動的追加
4. **設定のバリデーション**: より堅牢な設定管理
5. **エラーハンドリング**: 統一されたエラー処理
